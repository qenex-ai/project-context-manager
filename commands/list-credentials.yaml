---
name: list-credentials
description: List all stored credentials for current or global scope
version: 1.0.0

frontmatter:
  usage: |
    /list-credentials [--global]
  
  examples:
    - /list-credentials
    - /list-credentials --global

  arguments:
    - name: --global
      description: List global credentials
      required: false

script: |
  #!/bin/bash
  set -e

  GLOBAL="false"

  while [[ $# -gt 0 ]]; do
    case $1 in
      --global)
        GLOBAL="true"
        shift
        ;;
      *)
        echo "Unknown argument: $1"
        exit 1
        ;;
    esac
  done

  PROJECT_ROOT=$(git rev-parse --show-toplevel 2>/dev/null || pwd)
  PROJECT_NAME=$(basename "$PROJECT_ROOT")

  if [ "$GLOBAL" = "true" ]; then
    PREFIX="claude-code:global"
    echo "Global Credentials:"
  else
    PREFIX="claude-code:${PROJECT_NAME}"
    echo "Credentials for project: $PROJECT_NAME"
  fi

  echo "----------------------------------------"

  SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
  CREDS=$(bash "$SCRIPT_DIR/../scripts/credentials/keychain-wrapper.sh" list "$PREFIX")

  if [ -z "$CREDS" ]; then
    echo "No credentials found"
  else
    echo "$CREDS" | while read -r service; do
      NAME=$(echo "$service" | sed "s|${PREFIX}:||")
      echo "  â€¢ $NAME"
    done
  fi
